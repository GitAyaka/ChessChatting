<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è±¡æ£‹èŠå¤©å®¤</title>
    <link rel="icon" href="../img/iconbgnone.png" sizes="32x32">
    <link rel="stylesheet" href="./style/universalSettings.css">
    <link rel="stylesheet" href="./style/indexStyle.css">
    <link rel="stylesheet" href="./style/selfStyle.css">
    <link rel="stylesheet" href="./style/friendStyle.css">
    <link rel="stylesheet" href="./style/friendChatStyle.css">
    <link rel="stylesheet" href="./style/roomStyle.css">
    <link rel="stylesheet" href="./style/roomFixedStyle.css">
    <link rel="stylesheet" href="./style/roomChessBasicStyle.css">
    <script src="./libs/jQuery.min.js"></script>
    <script src="./script/self.js"></script>
    <script src="./script/friendChat.js"></script>
    <script src="./script/friend.js"></script>
    <script src="./script/roomChat.js"></script>
    <script src="./script/roomChess.js"></script>
    <script src="./script/room.js"></script>
    <style>
        .pointEventNone {
            pointer-events: none;
        }
        .displayNone {
            display: none;
        }
    </style>
    <embed src="/bgm.mp3" hidden="true" autostart="true" loop="true">
</head>
<body>
    <div id="navigationBar">
        <span id="friendsManage" class="bar" onclick="friendInfo(ID)">
            âœ” å¥½ å‹ èŠ å¤©
        </span>
        <span id="roomsManage" class="bar" onclick="roomInfo(ID)">
            âœ” è±¡ æ£‹ å¤§ å…
        </span>
        <span id="exercise" class="bar">
            <a href="./chess.html" target="_blank">âœ” å• æœº ç»ƒ ä¹ </a>
        </span>
        <span id="selfManage" onclick="selfInfo(ID)">
            âœ” ä¸ª äºº ä¸­ å¿ƒ ğŸ¤¡
        </span>
    </div>
    
    <div class="" id="leftFrame">
        <div class="tmp tmpRight" id="changeNameTips">
            <br>
            <p>ä½¿ ç”¨ è¯´ æ˜</p>
            <hr>
            <p>æœ¬ç³»ç»Ÿå¯ä»¥è¿›è¡ŒèŠå¤©å’Œä¸‹æ£‹</p>
            <p></p>
        </div>
    </div>
    
    <div id="mainFrame">
        <div class="tmp" style="text-align:center; position:relative; top:150px;">
            <img src="../img/iconbgnone.png" alt="" width="200px" height="200px">
            <h1 style="color:#4F9C9C ; position:relative; top:100px;">
                æ¬¢è¿ä½¿ç”¨è±¡æ£‹èŠå¤©å®¤ç³»ç»Ÿ
            </h1>
        </div>
    </div>

    <div class="" id="rightFrame">
        <div class="tmp tmpRight" id="changeNameTips">
            <br>
            <p>å… è´£ å£° æ˜</p>
            <hr>
            <p>æœ¬ç³»ç»Ÿä»…ç”¨ä½œå­¦ä¹ ç”¨é€”</p>
            <p></p>
        </div>

    </div>

    <script>
        // è·å–ç”¨æˆ·çš„ID
        const ID = location.search.substring(1);
        console.log(ID);

        /* é€šè¿‡æ£€æŸ¥IDæ˜¯å¦åˆæ³•ï¼Œæ£€æŸ¥æ˜¯å¦ç™»å½•äº† */
        if(ID.length != 13){
            window.location.assign("./login.html")
        }

        // ç”¨æˆ·è·å–è‡ªå·±çš„ä¿¡æ¯
        $.ajax({
            url:"http://localhost:8080/searchUserByUId?uId=" + ID,
            type:"GET",
            async:false,
            contentType:"application/json; charset=utf-8",
            dataType : 'json',
            success:function(res){
                console.log(res.length);
                // // é€šè¿‡æ£€æŸ¥æ˜¯å¦å­˜åœ¨æ­¤ç”¨æˆ·ï¼Œæ£€æŸ¥æ˜¯å¦ç™»å½•äº†
                // if(res.length == 0) {
                //     window.location.assign("./login.html");
                // }
                // é€šè¿‡æ£€æŸ¥ç”¨æˆ·çŠ¶æ€ï¼Œæ£€æŸ¥æ˜¯å¦ç™»å½•äº†
                if(res.state != 1){
                    window.location.assign("./login.html");
                }
                var self = JSON.stringify(res);
                localStorage.setItem("self"+ID, self);
            }
        })

        // var a = localStorage.getItem("self");
        // var b = JSON.parse(a);
        // console.log(b);

        // window.onbeforeunload=function (){
        //     if(event.clientX>document.body.clientWidth && event.clientY < 0 || event.altKey){
        //         alert("ä½ å…³é—­äº†æµè§ˆå™¨");
        //     }else{
        //         alert("ä½ æ­£åœ¨åˆ·æ–°é¡µé¢");
        //     }
        // }

        // $(window).unload(function(){ 
        //     //å“åº”äº‹ä»¶ 
        //     alert("è·å–åˆ°äº†é¡µé¢è¦å…³é—­çš„äº‹ä»¶äº†ï¼"); 
        // });

        // è·å–å¥½å‹ä¿¡æ¯
        // var returnFriendList = '';
        // $.ajax({
        //     url:"http://localhost:8080/getFriendList?uId=" + ID,
        //     type:"GET",
        //     async:false,
        //     contentType:"application/json; charset=utf-8",
        //     dataType : 'json',
        //     beforeSend:function(){
                
        //     },
        //     success:function(res){
        //         console.log(res);
        //         returnFriendList = res;
        //     }
        // })
        // console.log(returnFriendList);

        // å‡†å¤‡ä¸€ä¸ªå¯¹è±¡ç”¨æ¥æš‚å­˜æ¶ˆæ¯ï¼Œç„¶åè½¬æˆstringå­˜å‚¨åˆ°localstorageä¸­
        // var message = [];
        // var friendMessage = {
        //     fId:"",
        //     fMessage:message
        // }
        // var friendMessageList = [];


        // ä»åç«¯æ•°æ®åº“è·å–ç¦»çº¿æ¶ˆæ¯
        // è·å–ç¦»çº¿æ¶ˆæ¯
        // è¿™æ˜¯çœŸçš„ï¼Œè¿˜æ²¡å†™å®Œ
        // var allMessage = '';
        // $.ajax({
        //     url:"http://localhost:8080/getOfflineMsg",
        //     type:"GET",
        //     async:false,
        //     contentType:"application/json; charset=utf-8",
        //     data:{
        //         uId:ID
        //     },
        //     dataType : 'json',
        //     beforeSend:function(){
                
        //     },
        //     success:function(res){
        //         console.log(res);
        //         allMessage = res;
        //     }
        // })
        // console.log(allMessage);

        // æŠŠè·å–åˆ°çš„ç¦»çº¿æ¶ˆæ¯å­˜å‚¨åˆ°localstorageä¸­

        // ä¸æœåŠ¡ç«¯å»ºè®®åŒå‘é€šè®¯çš„é“¾æ¥
        // var wSck= new WebSocket("ws://localhost:8080/chat/" + ID);
        // // var wSck1= new WebSocket("ws://localhost:8081/chat/" + ID);
        // wSck.onopen = function() {
        //     console.log("connection success");
        // };
        // wSck.onerror = function() {
        //     console.log("connection error");
        // };

        // å‡†å¤‡æ¥æ”¶æ–°æ¶ˆæ¯
        // wSck.onmessage = function(resm) {
        //     //Decode JSON data into an object å¯èƒ½ä¸éœ€è¦ï¼Œçœ‹åç«¯è¿”å›ä»€ä¹ˆå†è¯´
        //     console.log(resm);
        //     var resmm = JSON.parse(resm);
        //     console.log(resmm);
        // };

        // console.log(wSck);
        // æŠŠæ–°æ¶ˆæ¯ä¹Ÿå†™å…¥localstorage
        // è¿™æ ·å¥½å‹èŠå¤©ç•Œé¢å°±å¯ä»¥ç›´æ¥ä»å‰ç«¯æ•°æ®åº“ä¸­è·å¾—æ¶ˆæ¯


        // var m0 =["ä½ å¥½","hh"]
        // var fm0 = {
        //     fId:123,
        //     fmessage:m0
        // }
        // var obj0 = [fm0]
        // console.log(obj0[0].fId);
        // console.log(obj0[0].fmessage[0]);
        // var mobjstring111 = JSON.stringify(obj0);
        // localStorage.setItem("meobj", mobjstring111);

        setTimeout(() => {
            // basicInfo();
            // declare();
        }, 10);
    </script>
    
</body>
</html>